= Создание вычисляемого поля

Выбор типа колонки [.keyword .parmname]_вычисляемого поля_ в качестве источника данных для элемента представления подразумевает, что отображаемые данные не хранятся ни в одном разделе карточки, а могут быть получены путем некоторых вычислений, правила которых задаются в специальным образом.

Вычисляемое поле дает возможность делать ограниченные вычисления типа формирования строки и простых арифметических операций на основе значений из колонок, которые указаны в таблице представления.

Таким образом, вычисляемое поле представляет собой совокупность элементов (и/или групп элементов), объединенных одной из следующих операций:

* объединение элементов строкового типа с помощью операции [+];
* арифметические операции сложения, умножения или вычитания – для элементов целого или дробного типа;
* логические операции объединения и пересечения [И] и [ИЛИ] – для элементов логического типа (Да\Нет).

Тип результата вычисляемого поля должен совпадать с типом колонки, которой сопоставлено это вычисляемое поле.

При выборе в поле [.ph .uicontrol]*Тип колонки* пункта [.kbd .ph .userinput]`Вычисляемое поле`, по кнопке image:img/Buttons/Select.png[image] поля [.ph .uicontrol]*Элемент* открывается окно [.keyword .wintitle]*Вычисляемое поле*, состоящее из секций [.keyword]*Элементы* и [.keyword]*Соответствие результатов* и соответствующих им кнопок управления.

image::img/Calculated_Field.png[[.fig--title-label]#Рис. 1. # Окно "Вычисляемое поле"]

В секции [.keyword]*Элементы* находится дерево, отображающее части, из которых складываются данные вычисляемого поля и операторы, их связывающие. В дерево могут быть включены как единичные элементы, так и группы элементов (узлы); вычисления внутри каждого узла проводится согласно некоторому оператору.

При добавлении в дерево нового узла вначале указывается оператор, применяемый к его элементам. Добавление оператора происходит по нажатию кнопки image:img/Buttons/If.png[image], открывающей диалоговое окно [.keyword .wintitle]*Элементы вычисляемого поля* (поля этого окна описаны в пункте xref:SettingView_Element_Grouping.adoc[Добавление оператора, объединяющего группу элементов]). После описания оператора в узел поочередно добавляются элементы объединяемой им группы.

Вторая секция этого окна – [.keyword]*Соответствие результатов* – позволяет указать, по каким принципам заменять значения полей, если эти значения являются для пользователя неинформативными (например, являются значениями некоторого перечисления). Описание этого поля и действий с ним приведено далее, в одноименном разделе данного руководства.

Новый элемент вычисляемого поля добавляется в выделенный узел дерева по нажатию кнопки image:img/Buttons/Add.png[image] [.ph .uicontrol]*Добавить* окна [.keyword .wintitle]*Вычисляемое поле*. При нажатии этой кнопки открывается окно [.keyword .wintitle]*Элемент вычисляемого поля*, в котором прежде всего выбирается тип добавляемого элемента:

* [.keyword .parmname]_простой_;
* [.keyword .parmname]_набор вариантов_;
* [.keyword .parmname]_набор условий_.

* *xref:../topics/SettingView_Element_Simple.adoc[Элемент вычисляемого поля типа 'Простой' и 'Перечисление']* +
* *xref:../topics/SettingView_Element_Set_of_Options.adoc[Элемент вычисляемого поля типа 'Набор вариантов']* +
* *xref:../topics/SettingView_Element_Set_of_Conditions.adoc[Элемент вычисляемого поля типа 'Набор условий']* +
* *xref:../topics/SettingView_Element_Grouping.adoc[Добавление оператора, объединяющего группу элементов]* +
* *xref:../topics/SettingView_Element_Comparison_of_Results.adoc[Сопоставление результатов]* +
* *xref:../topics/SettingView_Example_Display_Settings_Currency.adoc[Пример настройки отображения валюты]* +

*На уровень выше:* xref:../topics/SettingView_Setting_AdminDV.adoc[Дополнительные возможности настройки]
